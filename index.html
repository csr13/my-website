<!DOCTYPE html>
<!-- Si estas por aqui, eres un/a stalker, o de plano medio curioso/a en todo caso -->
<!-- No uso auto generadores estaticos, me gusta escribir todo esto asi a mano, mega OCD -->
<html>
    <head>
        <title>ðŸ—‘</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="My dump">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="./static/vendors/css/highlight.min.css" />
        <style>
            body {font-family: monospace;}
            header{margin-bottom: 15px;}
            .pre-code {white-space: pre; background: whitesmoke; border:
                1px solid lightgrey; padding:5px; overflow: auto;}
            #title{color: white;background-color:rgba(0,0,255,.50);}
            #twista{background-color: rgba(0,0,255,.50); color: white;}
            .meme-sized{width: 100px; height: 100px;}
            .black-background{background-color:black}
            .snake-style{color:limegreen;background:black;border:1px solid crimson;}
            .warning-style{color:yellow;background:black;border:1px solid yellow;}
            .happy-style{color:limegreen;background:blue;border:1px solid limegreen;}
            .trans-style{color: white; background: pink; border: 3px solid lightblue;}
            .block-of-code{background: black; border 1px solid crimson; width: auto; overflow: auto;}
            .block-of-code code {color: white; overflow: auto; width:auto; display: block;}
            .main-nav{height: 20px}
            .nav-link{color: white; background: blue; border: 3px solid black;}
            .nav-link:not(:first-of-type){margin-left: 5px;}
            .sticky{position: fixed; top:2;}
            .note{box-shadow: 3px 6px black; border: 2px groove black;
                margin-bottom: 20px;}
            .note-title{padding:0px 10px 10px 10px;}
            .note-body{padding:0px 10px 10px 10px;}
            .counter{margin-bottom: 10px;}
            .counter div {background: white; padding: 3px; border: 3px solid
                black}
            .flex{display: flex;}
            .flex-row{flex-direction: row;}
            .space-between{justify-content: space-between;}
            .signature-right{
                padding:0; margin:0; 
                border-left: 2px groove black; 
                border-bottom: 2px groove black
            }
            .signature-left{
                padding:0; 
                margin:0; 
                border-right: 2px groove black; 
                border-bottom: 2px groove black
            }
            #loading {
                display: block;
                position: absolute;
                top: 0;left: 0;z-index: 100;
                width: 100vw;
                height: 100vh;
            }
            #page {
                display: none;
            }
            #loading-image{
                height: 100px;
                width: 100px;
            }
        </style>
        <script>
            function onReady(callback) {
                var id = window.setInterval(c1, 1000);
                function c1() {
                    if (document.getElementsByTagName('body')[0] !== undefined) {
                        window.clearInterval(id);
                        callback.call(this);
                    }
                }
            }

            function s1(id, value) {
                document
                    .getElementById(id)
                    .style
                    .display = value ? 'block' : 'none';
            }

            onReady(function () {
                s1('page', true);
                s1('loading', false);
            });
        </script>
    </head>
    <body id="page">
        <div id="loading"></div>
        <header>
            <div class="main-nav">
                <nav class="sticky">
                    <a class="nav-link happy-style" id="dark-mode-trigger"/> 
                        Dark mOde 
                    </a>
                </nav>
            </div>
        </header>

        <!-- notes -->
        <div class="notes">
            <div class="note" >
                <div class="note-title">
                    <h3>
                        A rant on implementing API's -- 
                        from pure experience, not books or
                        youtube tutorials.
                    </h3>
                </div>
                <div class="note-body">
                    In my opinion,
                    <ol>
                        <li>
                            Monolithic small frameworks are good if the purpose is a micro
                            service that can be written in less than 1000 lines of
                            code, and can be reusable, and pluggable -- my personal opinion.
                        </li>
                        <li>
                            Validation/Verification is always one of the first things to do,
                            if you want to provide the end user of the system with a
                            pleasant usage experience.
                        </li>
                        <li>
                            Database relations, using foreign keys to create
                            relational models, not text id's, otherwise, deletion of
                            related models is a real pain, it is important to point
                            this out to the entry level engineers.
                        </li>
                        <li>
                            Document the endpoints, check know OpenApi, leverage
                            tools like swagger -- for django or I recommend using
                            drf-yasg, and applying <code style="background:
                                                                black; color: white;">@swagger_auto_schema</code>
                            decorator with both request body, query parameter and
                            response serializers to provide accurate
                            description on what the endpoint needs for context
                            negotiation, and what it returns. You can specify all
                            status code of responses, good, leverage it, use it. Make
                            frontend team happy to work with you, and gain good
                            karma.
                        </li>

                        <li>
                            Scaling up is fucking easy, scaling down, not so much.
                        </li>
                        <li>
                            Sometimes threading is better than integrating an entire
                            task management system, for fucks sake.
                        </li>
                        <li>
                            Do not allow the entry level developer to refactor, just
                            write detailed tasks, and make him/her follow them to the
                            letter.
                        </li>
                        <li>
                            Refactor comes after v1 is stable. End of discussion.
                        </li>
                        <li>
                            Sometimes management will make the mistake of asking
                            entry level developers on estimates for tasks, correct
                            this mistake by making management understand, not all
                            engineers have the same level of skill/experience.
                            Situations like this fuck the so called 'Agile' bullshit
                            planning.
                        </li>
                        <li>
                            Work as a team, if you are a new engineer, do not be the egocentric developer,
                            there is someone else who will come and make an example
                            of you. No matter how good you are .. emm *claim to be**, 
                            you will lack expereince. Need to be battle
                            tested, that means, at leats, perhaps, going through a couple of
                            erroneous managerial estimates for high profile, big
                            investment clients. Enough suffering that will make
                            you question your carrer choices. You need to overcome
                            not having a social life, being assigned to contribute
                            to an important system and suffer because of
                            deadlines. Watching on the sidelines as losers
                            interact with your crush, while you sit, pathetic at your
                            workstation trying to make the deadline -- this is they
                            way to pacify egocentric entry level developers.
                        </li>
                        <li>
                            A good coffee machine will save you money in the long
                            run.
                        </li>
                    <ol>
                </div>
            </div>
            <div class="note" >
                <div class="note-title">
                    <h3>Celery Flower and Worker</h3>
                </div>
                <div class="note-body">
                    <p>
                    Sometimes deploying systems with asynchronous tasks is
                    required per client specifications.
                    </p>
                    <p>
                    For these instances I tend to dockerize celery redis and
                    monitor them with Flower, which provides visualization for
                    the performance of system asychronous tasks.
                    <div class="pre-code"><code>
    version: '3.9'

    services:
    .... rest of services (redis, etc)
    tasks:

        build:
        context: .
        dockerfile: ./docker/tasks/Dockerfile
        command: >
        sh -c "python3 -m celery -A my_system flower --address=0.0.0.0 --port=5566 &;

                python3 -m celery -A my_system worker -l INFO -E"
        env_file:
        - ./docker/tasks/.env
        depends_on:
        - redis
        restart: unless-stopped
        network:
        my-network:
            ipv4_address: 10.10.10.2
        expose:
        - "5566"

    networks:
    ... network config</code>
                    </div>
                    <small>
                        On the command: section of the dockerfile, putting flower
                        on the background so the worker can operate normally, notice
                        the ampersand <code> & </code> and the <code> ; </code> if
                        the previous command fails, the container won't be marked as
                        <code>exited</code> by the docker daemon.
                    </small>
                    <p>
                        Usually setting up a shared task monitoring tool over public
                        http is not the best idea.

                        I pipe to my remote workstation machine all flower instances for all
                        systems using ssh
                    </p>
                    <div class="pre-code"><code>
    ~$ ssh -L 10.10.10.2:5566:127.0.0.1:8001 -i my_system.pem user@$MY_SYSTEM_IP</code>
                    </div>
                    <p>
                    Open browser at <code> 127.0.0.1:8001 </code> and monitor my
                    systems shared tasks, configure rate limits, etc ....
                    <br>
                    You can fine tune flower, check out their documentation
                    </p>
                </div>
            </div>
            <div class="note" >
                <div class="note-title">
                    <h3> Decided to add some vendor libs </h3>
                </div>
                <div class="note-body">
                    <p> Have been a little against loading vendor libraries to my site,
                    however, needed some syntax higlighter and added
                    <a href="https://highlightjs.org" target="_blank">highlight.js</a>
                     for better clarity.
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3> Dicking Down IP's for good</p>
                </div>
                <div class="note-body">
                    <p>
                        IP is a standard protocol, STD 5 (Standard 5) meaning, it has
                        been approved by the IAB (Internet Advisory Board) a sort of
                        branch of the 
                        IEFT (Internet Engeneering Task Force) the one who issues the
                        standards,  as well as the IANA (Internet Assigned Board). IP is the Internet
                        Protocol, and IP number, is just a number used to id stuff on that protocol.
                    </p>
                    <p>
                        The Internet Protocol is an unreliable, connectionless packet
                        delivery protocol, and it assumes that data can be lost
                        during delivery, but since it is part of the OCI model
                        (read below) it assumes higher protocols handle the loss of
                        data during delivery aka catching errors.
                    </p>
                    <p>
                        The usage of a connectionless packet delivery method
                        tackles the issue of it depending on central computing
                        centers that use other networks models. The DOD (Department of Defence of the United States) 
                        decided to deploy a network that was best suitable to evade network distuption
                        in an unforseen event that could compromise lines of
                        communication in a certain geographical location, and so the
                        network was deployed to counter any such event, and
                        it has been proven true and works.
                    </p>
                    <p>
                        <h4> IP numbers </h4>
                        <p>
                        IP numbers are 32-bit unsigned values, they are expressed
                        like this 10.10.10.1 in a dotted decimal notation.
                        </p>   
                            IP address = {network number}-{host number}
                            <br>
                            192.2[network address].10.2[host number] 
                        <p>
                            In binary it looks like this.
                            <br>
                                11000000.00000010.00001010.00000010
                        </p>
                        <p>
                            Shortcut to convert IP nums to binary
                        </p>
                        <div class="pre-code">
<code>#!/bin/bash
# This can go inside a loop after cating file of IP's

ip=$1
temp=$(echo $ip | sed 's/\./;/g');
binary_ip=$(echo "obase=2;$temp" | bc | tr -d '\n');
printf "%d\n" $binary_ip</code>
                        </div>
                        </p>
                        <p>
                            These addresses are used by the Internet Protocol to
                            identify hosts on the internet
                            <h4> Five classes of IP addresses and it's usages +
                                brief properties </h4>
                            <ol>
                                <li>Class A - these use 7 bits of the network section
                                and 24 bits for the host section -- suitable for
                                networks with many hosts.</li>
                                <li>Class B - these use 14 bits for the network
                                    section and 16 for the host section -- suitable
                                    for networks with a medium-large number of hosts.</li>
                                <li>Class C - these use 21 bits for the network
                                    section, and 8 bits for the host section --
                                    suitable for a network with a small number of
                                    hosts.</li>
                                <li>Class D - these are used for multicasting.</li>
                                <li>Class E - these are of experimental use.</li>
                            </ol>
                        </p>
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3>OCI Review<h3>
                </div>
                <div class="note-body">
                    <p> Open Systems Interconnection Reference Model</p>
                    <small> FOr people getting into INFOSEC, this is crucial </small>

                    <p> 
                        It is a reference for how a network protocol stack should operate.
                        Each layer provides a set of function to communicate with the
                        layer above, and it also relies on sets of function from the
                        layer below ... Vertical Communication. 
                    </p>
                    <h3>The 7 layers</h3>
                    <ol>
                        <li>
                            Application - File Transfers, Emulators, Restful APIS
                        </li>
                        <li>
                            Presentation - Formating of information or encryption
                        </li>
                        <li>
                            Session - Keep Alive Sessions
                        </li>
                        <li>
                            Transport - Reliable END 2 END transport (TCP/IP UDP Protocols, etc)
                        </li>
                        <li>
                            Network - Packet deliver, routing.
                        </li>
                        <li>
                            Data Link - Framing of information units and error
                            handling.
                        </li>
                        <li>
                            Physical - Transmission of bits on the actual hardware.
                        </li>
                    </ol>
                    <p>
                        <bold>Most</bold> applications regular users of the internet use are at
                        the Application, Presentation, and Session levels of the OCI Model.
                    </p>
                    <small> Source: IBM TCP/IP Technical Overview, Sixth Edition</small>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3> % digits deployments</h3>
                </div>
                <div class="note-body">
                    <p>
                        Deploying stuff on servers, could be just relayer api's for remote
                        RPC's on complex systems .. whatever .. 
                    </p>
                    <p>
                        If the server is not hosted on a cloud provider, then a simple
                        IPTABLES execution will do it, given the server is LInuX, can be
                        house computer, but need to modify  your router to redirect incomming
                        traffic to port whatever to machine serving IP, that machine has some
                        reverse proxy sitting infront of it.
                        <br>
                    <p> open up some ports </p>
                    <div class="pre-code"><code>
iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT
iptables -I INPUT -p tcp -m tcp --dport 443 -j ACCEPT</code>
                    </div>
                    </p>
                    <p> 
                        For now docker-compose example for serving a static site w nginx,
                        pretty stupid and noob, the spin are the quirks for hardening the web
                        server and scoring over a D on <code> securityheaders.org </code>,
                        and proxy log analysis for monitoring. Remoteley smart competition
                        can eat your bread by presenting a report with your application list
                        of vulnerabilities, because not many devs are security oriented, they
                        just want to turn in a job and get paid.
                    <p>
                        <bold> 
                            A compose file for the host (install docker & docker-compose)
                        </bold>
                        <script src="https://gist.github.com/xzan0x7c7/47c6d328ef4994ab9e763d6c67de51da.js"></script>
                        <small> 
                        Enabling volumes to avoid rebuilding app, and editing directly on
                        host, not on container, saves the sysadmin time. 
                        </small>
                    <p> Dockerfile located on build context nginx/Dockerfile </p>
                    <script src="https://gist.github.com/xzan0x7c7/d70df65dd94a475ef4b90c4c57ec5f8f.js"></script>
                    <p> Nginx conf file </p>
                    <script src="https://gist.github.com/xzan0x7c7/24060a789672b2f1a7d4a9cdb8a41df8.js"></script>
                    <p> 
                        <br>
                        However, I am now interested in monitoring visitors and
                        keeping track of IP's by parsing my reverse proxy logs, I don't wanna use
                        something like Dynatrace or New Relic, because I am interested in using
                        something like OpenCTI to monitor APT's on my stupid website.
                        <br><br>
                    <div class="pre-code"><code>
# dump logs 2 file
~$ docker-compose logs --follow web-server &> /var/log/web-server.log &</code>
                    </div>
                    <small> Start listening to container logs on the background, could be
                    done as a systemctl unit file, but this serves the purpose,
                    monitor this process and kill it with htop or the <code>kill</code> cmd
                    </small>
                    <br>
                    <br>
                    <p>
                        For the purpose a super simple shell or python script to parse
                        this log file works, only want something fairly stupid, which is to extract ip, with
                        datetime from the logfile, so to ship it to any analysis
                        program or system -- for further analysis, in this case further
                        processing for analysis and visualization.
                    </p>
                    <div class="pre-code"><code>
#!/bin/bash
grep -E -o "([0-9]{1,3}[\.]){3}[0-9]{1,3}\s-\s-\s\[[0-9]{1,2}\/\w+\/[0-9]{4}\:[0-9]{2}\:[0-9]{2}\:[0-9]{2}.*\]" /var/log/web-server.log > /usr/share/data/monitoring/web-server-visitors.txt</code>
                    </div>
                    <p>
                    <div style="width: auto; height: 350px;overflow: auto;">
                        <img src="./static/images/gifs/ips.gif" width=auto/>
                    </div>
                    <small> 
                    <code> 
                    testing the code above
                    </code>
                    </small>
                    <br>
                    <br>
                    The date can serve as a distinct reference point for entries on
                    whatever storage unit u wish to persist analysis.
                    <br><br>
                    The last step is to cook a script to load this file, and either
                    send it as a batch to another server on the same network, or,
                    another network running some api that receives this data and
                    analyses with a forensics tool like OpenCTI (open source).
                    <br>
                    <br>
                    <div class="pre-code"><code>
#!/bin/bash
curl -d @/usr/share/data/monitoring/web-server-visitors.txt http://10.0.10.2/analyze-web-server-visistors</code>
                    </div>
                    <small>
                    Either add this script with 
                    <code class="happy-style">
                    crontab -e
                    </code> or add it to 
                    <code class="happy-style"> 
                    /etc/cron.hourly 
                    </code>
                    </small>
                    <br>
                    <br>
                    Malicious people would then instead of doing APT analysis, would
                    stupidly use a tool like nmap or greenbone to scan that IP for
                    open ports, and do recoinassance on visitors, for further
                    malicious activity.
                    </p>
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3>
                        <span class="trans-style">Big Diference </span>
                    </h3>
                </div>
                <div class="note-body">
                    <p>
                        Big fucking difference in between a transexual and a transvestite you
                        fucking ignorant piece of shit. A 
                        <span class="trans-style">transexual</span> 
                        is someone who medically transitions via cellular genetic hack through modifying
                        protein synthesis via hormonal replacement therapy, developing
                        goodies like tits and femenine fat redistribution as well as soft
                        skin and cute face, female body smell, etc.. ........ and transvestite is
                        someone who just dresses like a female for the thrill of it ... I
                        can't make a single motherfucker out of 10 of you idiots -- If I was
                        the dad of any of you I would be ASHAMED of you -- HAIL SATAN BITCH!!
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3>
                        <span class="happy-style">Infected 0 trust</span>
                    </h3>
                </div>
                <div class="note-body">
                    <p>
                        Assume everything is infected by applying a 0 trust policy, every component, switch, router is infected,
                        the internet is infected with satanic methods designed to influence
                        your choice of actions, BlaK Ops zecTS owns your shit.
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3>
                        <code>
                        <span class="warning-style"> Pathetic</span>
                        </code>
                    </h3>
                </div>
                <div class="note-body">
                    <p>
                        Do you know how pathetic you are not trying to be something you are not?
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3> It's not that I hate you.</h3>
                </div>
                <div class="note-body">
                    <p> 
                        I don't hate you, it's only that you have proven to be a
                        piece of crap to everyone you are/were close to. 
                        <br>
                        <br>
                        How in the fuck will I ever consider any sort of relationship
                        with you if all you do is hate on your own people?
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3> Chronically Alive</h3>
                </div>
                <div class="note-body">
                    <p>
                        GET FUCKING HELP YOU DEMENTED MANIPULATIVE SNAKE 
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3> Nonesense</h3>
                </div>
                <div class="note-body">
                    <p>
                        Do you have really bad autism, to the point were you screeeeeam!!!!
                        fucking lound when the salad dressing touches the meat on a plate? 
                    </p>
                </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3>You bore me.</h3>
                </div>
                <div class="note-body">
                    <p> 
                        You bore me with academic linguistics.
                        <br>
                        <span class="snake-style">
                        ~$ systemctl disable your-ass.service && rm -v /etc/system/systemd/your-ass.service
                        </span>
                        </code>
                    </p>
            ; margin-bottom: 10px;    </div>
            </div>
            <div class="note">
                <div class="note-title">
                    <h3>  management, systems, django .. BORING </h3>
                </div>
                <div class="note-body">
                    <p> 
                        Sometimes u just don't want to add 3rd party packages to handle crons
                        for backend web api's that run on python and django, so here is a STUPID
                        way of doing it. Add stuff to 
                        <code>/etc/cron.daily</code> 
                        or 
                        <code> /etc/cron.hourly </code>
                    </p>
                    <script src="https://gist.github.com/xzan0x7c7/3a065ca7bf0e93eed85e8757b97a968e.js"></script>
                </div>
            </div>
        </div>
        <!-- end of notes -->
        <script src="./static/vendors/js/highlight.min.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function() {

                var state = {"darkMode" : false}
             
                function modeSwitch() {
                    var t = document.getElementById("dark-mode-trigger")
                    t.addEventListener("click", function(e) {
                        if (state.darkMode) {
                            t.innerText = "Dark mOde"
                            state.darkMode = false
                            setMode("light")
                        } else {
                            t.innerText = "Light mOde"
                            state.darkMode = true
                            setMode("dark")
                        }
                    })
                }
                
                function setMode(mode) {
                    var t = document.getElementsByTagName("body")[0];
                    if (mode == "light") {
                        t.style.background = "white";
                        t.style.color = "black"
                    } else {
                        t.style.background = "black";
                        t.style.color = "white"
                    }
                }
                
                function setHj() {
                    document.querySelectorAll('.pre-code code').forEach((el) => {
                        hljs.highlightElement(el);
                    });
                }

                function i1() {
                    var notes = document.getElementsByClassName("note");
                    for (let i = 0; i < notes.length; i++) {
                        var t1 = notes[i]
                        var t2 = t1.children[0]
                        var d1 = document.createElement("div")
                        var sl = document.createElement("div")
                        var sr = document.createElement("div")
                        var g1 = document.createElement("img")
                        var g2 = document.createElement("img")
                        
                        d1.classList.add("flex")
                        d1.classList.add("flex-row")
                        d1.classList.add("space-between")
                        
                        g1.height = 20; g1.width = 20;
                        g2.height = 20; g2.width = 20;
                        g1.src = "./static/images/gifs/me.gif"
                        g2.src = "./static/images/gifs/me.gif"
                        
                        d1.appendChild(sl)
                        d1.appendChild(sr)
                        
                        if (i % 2 == 0) {
                            sl.classList.add("signature-left");
                            sl.appendChild(g1)
                        } else {
                            sr.classList.add("signature-right");
                            sr.appendChild(g2)
                        }
                        
                        t1.insertBefore(d1, t2)
                    }
                }
                
                function i2() {
                    return false
                }
                
                function ri() {
                    window.clearInterval(i1);
                    window.clearInterval(i2);
                }
                
                function main() {
                    modeSwitch()
                    setHj()
                    i1()
                    const si2 = window.setInterval(i2, 4000)
                    window.onbeforeunload = ri;
                }

                main()
            })
        </script>
    </body>
</html>
