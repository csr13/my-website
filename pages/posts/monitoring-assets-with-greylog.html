<html>
    <head>
        <title>Setting up greylog to monitor server assets in your networks.</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="My dump">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/static/css/main.css" />
        
    </head>
    <body>
        <header>
            <h2> <a style="text-decoration: none;"href="/">Notes</a></h2>
        </header>
        
    <div class="note">
        <div class="note-title">
            <h3>Setting up greylog to monitor server assets in your networks.</h3>
            <p>Date: 2023-11-12<br>By: csr13</p>
        </div>
        <div class="note-body">
            <p>For setting graylog a docker-compose.yml file is enough to do the job; check docker and docker compose are installed on the system and then change to the root user, create a folder on /root/graylog</p>
<p>Create docker-compose.yml file and copy paste this then run: $ docker-compose up</p>
<pre><code>version: '3'

services:
  mongo:
    image: mongo:5.0.13
    networks:
      - graylog
    volumes:
      - mongo_data:/data/db

  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch-oss:7.10.2
    environment:
    - http.host=0.0.0.0
    - transport.host=localhost
    - network.host=0.0.0.0
    - &quot;ES_JAVA_OPTS=-Dlog4j2.formatMsgNoLookups=true -Xms512m -Xmx512m&quot;
    ulimits:
      memlock:
        soft: -1
        hard: -1
      deploy:
    resources:
          limits:
            memory: 1g
      networks:
        - graylog
      volumes:
    - es_data:/usr/share/elasticsearch/data

  graylog:
    image: graylog/graylog:5.0
    environment:
      - GRAYLOG_PASSWORD_SECRET=logginglogger123
      - GRAYLOG_ROOT_PASSWORD_SHA2=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918
      - GRAYLOG_HTTP_EXTERNAL_URI=http://127.0.0.1:9000/
    entrypoint: /usr/bin/tini -- wait-for-it elasticsearch:9200 --  /docker-entrypoint.sh
    networks:
      - graylog
    restart: always
    depends_on:
      - mongo
      - elasticsearch
    ports:
  # Graylog web interface and REST API
      - 9000:9000
  # Syslog TCP
      - 1514:1514
  # Syslog UDP
      - 1514:1514/udp
  # GELF TCP
      - 12201:12201
  # GELF UDP
      - 12201:12201/udp
  # TST TCP
      - 5555:5555
    volumes:
      - graylog_data:/usr/share/graylog/data

volumes:
  mongo_data:
    driver: local
  es_data:
    driver: local
  graylog_data:
    driver: local

networks:
  graylog:
    driver: bridge

</code></pre>
<p>This will expose the application on port 9000, redirect with nginx to port 80 or establish a piped connection to graylog via ssh to your localhost:5000 :</p>
<pre><code>ssh -i &lt;pem file&gt; -L 127.0.0.1:5000:127.0.0.1:9000 &lt;user&gt;@&lt;log-server-ip&gt;
</code></pre>
<p>Default credentials:</p>
<pre><code>Username: admin
Password: admin
</code></pre>
        </div>
    </div>

        
        <script src="/static/js/main.js"></script>
    </body>
</html>